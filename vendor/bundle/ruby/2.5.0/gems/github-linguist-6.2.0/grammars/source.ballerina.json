{
  "name": "Ballerina",
  "scopeName": "source.ballerina",
  "patterns": [
    {
      "include": "#publicKeyword"
    },
    {
      "include": "#functionDec"
    },
    {
      "include": "#serviceDec"
    },
    {
      "include": "#documentationDef"
    },
    {
      "include": "#typeDef"
    },
    {
      "include": "#objectDec"
    },
    {
      "include": "#annotationDec"
    },
    {
      "include": "#code"
    }
  ],
  "repository": {
    "annotationDec": {
      "patterns": [
        {
          "name": "storage.type.annotation.ballerina",
          "match": "@([a-zA-Z_]([a-zA-Z0-9_])*)|(\\^\"([^|\"\\\\\\f\\n\\r\\t]|\\\\\\\\[btnfr]|\\\\[|\"\\\\/])+\")"
        }
      ]
    },
    "booleans": {
      "patterns": [
        {
          "name": "constant.language.boolean.ballerina",
          "match": "\\b(true|false)\\b"
        }
      ]
    },
    "butExp": {
      "patterns": [
        {
          "begin": "\\b(but)\\b",
          "end": "(?\u003c=\\})",
          "patterns": [
            {
              "include": "#matchStatementBody"
            },
            {
              "include": "#comment"
            }
          ],
          "beginCaptures": {
            "1": {
              "name": "keyword.ballerina"
            }
          }
        }
      ]
    },
    "code": {
      "patterns": [
        {
          "include": "#booleans"
        },
        {
          "include": "#keywords"
        },
        {
          "include": "#strings"
        },
        {
          "include": "#maps"
        },
        {
          "include": "#paranthesised"
        },
        {
          "include": "#paranthesisedBracket"
        },
        {
          "include": "#numbers"
        },
        {
          "include": "#comment"
        },
        {
          "include": "#matchStatement"
        },
        {
          "include": "#butExp"
        },
        {
          "include": "#identifiers"
        }
      ]
    },
    "comment": {
      "patterns": [
        {
          "name": "comment.ballerina",
          "match": "\\/\\/.*"
        }
      ]
    },
    "constrainType": {
      "patterns": [
        {
          "begin": "\u003c",
          "end": "\u003e",
          "patterns": [
            {
              "include": "#comment"
            },
            {
              "include": "#continuedType"
            },
            {},
            {
              "name": "storage.type.constrain.ballerina",
              "match": "\\b(([a-zA-Z_]([a-zA-Z0-9_])*)|(\\^\"([^|\"\\\\\\f\\n\\r\\t]|\\\\\\\\[btnfr]|\\\\[|\"\\\\/])+\"))\\b"
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.parameters.begin.ballerina"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.parameters.end.ballerina"
            }
          }
        }
      ]
    },
    "continuedType": {
      "patterns": [
        {
          "begin": "[|,:]",
          "end": "\\b(([a-zA-Z_]([a-zA-Z0-9_])*)|(\\^\"([^|\"\\\\\\f\\n\\r\\t]|\\\\\\\\[btnfr]|\\\\[|\"\\\\/])+\"))\\b",
          "patterns": [
            {
              "include": "#comment"
            }
          ],
          "endCaptures": {
            "1": {
              "name": "storage.type.ballerina"
            }
          }
        }
      ]
    },
    "defaultValue": {
      "patterns": [
        {
          "begin": "[=:]",
          "end": "(?=[,)])",
          "patterns": [
            {
              "include": "#code"
            }
          ]
        }
      ]
    },
    "documentationBody": {
      "patterns": [
        {
          "begin": "\\{",
          "end": "\\}",
          "patterns": [
            {
              "match": "(P|R|T|F|V)({{)(.+)(}})",
              "captures": {
                "1": {
                  "name": "keyword.other.ballerina.documentation"
                },
                "2": {
                  "name": "keyword.other.ballerina.documentation"
                },
                "3": {
                  "name": "variable.parameter.ballerina.documentation"
                },
                "4": {
                  "name": "keyword.other.ballerina.documentation"
                }
              }
            },
            {
              "name": "comment.block.code.ballerina.documentation",
              "begin": "\\```",
              "end": "\\```"
            },
            {
              "name": "comment.block.code.ballerina.documentation",
              "begin": "\\``",
              "end": "\\``"
            },
            {
              "name": "comment.block.code.ballerina.documentation",
              "begin": "\\`",
              "end": "\\`"
            },
            {
              "name": "comment.block.ballerina.documentation",
              "match": "."
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.block.ballerina.documentation"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.block.ballerina.documentation"
            }
          }
        }
      ]
    },
    "documentationDef": {
      "patterns": [
        {
          "begin": "\\b(documentation|deprecated)\\b",
          "end": "(?\u003c=\\})",
          "patterns": [
            {
              "include": "#documentationBody"
            }
          ],
          "beginCaptures": {
            "1": {
              "name": "keyword.ballerina"
            }
          }
        }
      ]
    },
    "functionBody": {
      "patterns": [
        {
          "begin": "\\{",
          "end": "\\}",
          "patterns": [
            {
              "include": "#comment"
            },
            {
              "include": "#code"
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.block.ballerina"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.block.ballerina"
            }
          }
        }
      ]
    },
    "functionDec": {
      "patterns": [
        {
          "begin": "\\b(function)\\b",
          "end": "(?\u003c=\\})",
          "patterns": [
            {
              "include": "#functionReceiver"
            },
            {
              "include": "#functionParameters"
            },
            {
              "include": "#functionReturns"
            },
            {
              "include": "#functionName"
            },
            {
              "include": "#functionBody"
            },
            {
              "include": "#comment"
            }
          ],
          "beginCaptures": {
            "1": {
              "name": "keyword.ballerina"
            }
          }
        }
      ]
    },
    "functionName": {
      "patterns": [
        {
          "name": "entity.name.function.ballerina",
          "match": "([a-zA-Z_]([a-zA-Z0-9_])*)|(\\^\"([^|\"\\\\\\f\\n\\r\\t]|\\\\\\\\[btnfr]|\\\\[|\"\\\\/])+\")"
        }
      ]
    },
    "functionParameters": {
      "patterns": [
        {
          "begin": "\\(",
          "end": "\\)",
          "patterns": [
            {
              "include": "#varDefStatement"
            },
            {
              "include": "#defaultValue"
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.parameters.begin.ballerina"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.parameters.end.ballerina"
            }
          }
        }
      ]
    },
    "functionReceiver": {
      "patterns": [
        {
          "begin": "\u003c",
          "end": "\u003e",
          "patterns": [
            {
              "include": "#varDefStatement"
            },
            {
              "include": "#comment"
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.parameters.begin.ballerina"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.parameters.end.ballerina"
            }
          }
        }
      ]
    },
    "functionReturns": {
      "patterns": [
        {
          "begin": "\\breturns\\b",
          "end": "(?=\\{)",
          "patterns": [
            {
              "name": "storage.type.ballerina",
              "match": "([a-zA-Z_]([a-zA-Z0-9_])*)|(\\^\"([^|\"\\\\\\f\\n\\r\\t]|\\\\\\\\[btnfr]|\\\\[|\"\\\\/])+\")"
            },
            {
              "include": "#comment"
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "keyword.ballerina"
            }
          }
        }
      ]
    },
    "identifiers": {
      "patterns": [
        {
          "name": "variable.other.ballerina",
          "match": "([a-zA-Z_]([a-zA-Z0-9_])*)|(\\^\"([^|\"\\\\\\f\\n\\r\\t]|\\\\\\\\[btnfr]|\\\\[|\"\\\\/])+\")"
        }
      ]
    },
    "keywords": {
      "patterns": [
        {
          "name": "keyword.control.ballerina",
          "match": "\\b(if|else|iterator|try|catch|finally|fork|join|all|some|while|foreach|in|throw|return|returns|break|timeout|transaction|aborted|abort|committed|failed|retries|next|bind|with|lengthof|typeof|enum)\\b"
        },
        {
          "name": "keyword.other.ballerina",
          "match": "\\b(import|version|public|private|attach|as|native|documentation|lock)\\b"
        },
        {
          "name": "keyword.other.siddhi.ballerina",
          "match": "\\b(forever|from|on|select|group|by|having|order|where|followed|insert|into|update|delete|set|for|window|query)\\b"
        },
        {
          "name": "keyword.other.ballerina",
          "match": "\\b(annotation|package|type|typedesc|connector|function|resource|service|action|worker|struct|transformer|endpoint|object)\\b"
        },
        {
          "name": "keyword.other.ballerina",
          "match": "\\b(const|true|false|reply|create|parameter)\\b"
        },
        {
          "name": "keyword.operator.ballerina",
          "match": "(!|%|\\+|\\-|~=|==|=|!=|\u003c|\u003e|\u0026\u0026|\\|\\||\\?:)"
        },
        {
          "include": "#types"
        }
      ]
    },
    "maps": {
      "patterns": [
        {
          "begin": "\\{",
          "end": "\\}",
          "patterns": [
            {
              "include": "#comment"
            },
            {
              "include": "#code"
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.string.begin.ballerina"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.string.end.ballerina"
            }
          }
        }
      ]
    },
    "matchStatement": {
      "patterns": [
        {
          "begin": "\\b(match)\\b",
          "end": "(?\u003c=\\})",
          "patterns": [
            {
              "name": "variable.parameter.ballerina",
              "match": "([a-zA-Z_]([a-zA-Z0-9_])*)|(\\^\"([^|\"\\\\\\f\\n\\r\\t]|\\\\\\\\[btnfr]|\\\\[|\"\\\\/])+\")"
            },
            {
              "include": "#matchStatementBody"
            }
          ],
          "beginCaptures": {
            "1": {
              "name": "keyword.ballerina"
            }
          }
        }
      ]
    },
    "matchStatementBody": {
      "patterns": [
        {
          "begin": "\\{",
          "end": "\\}",
          "patterns": [
            {
              "include": "#varDefStatement"
            },
            {
              "include": "#matchStatementPatternClause"
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.block.ballerina.documentation"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.block.ballerina.documentation"
            }
          }
        }
      ]
    },
    "matchStatementPatternClause": {
      "patterns": [
        {
          "begin": "=\u003e",
          "end": "((?\u003c=\\})|;|,)",
          "patterns": [
            {
              "include": "#functionBody"
            },
            {
              "include": "#code"
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "keyword.ballerina"
            }
          }
        }
      ]
    },
    "numbers": {
      "patterns": [
        {
          "name": "constant.numeric.decimal.ballerina",
          "match": "\\b[0-9]+\\b"
        }
      ]
    },
    "objectBody": {
      "patterns": [
        {
          "begin": "\\{",
          "end": "\\}",
          "patterns": [
            {
              "include": "#varDefBlock"
            },
            {
              "include": "#objectInitDec"
            },
            {
              "include": "#functionDec"
            },
            {
              "include": "#comment"
            },
            {
              "include": "#code"
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.block.ballerina"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.block.ballerina"
            }
          }
        }
      ]
    },
    "objectDec": {
      "patterns": [
        {
          "begin": "\\b(object)\\b",
          "end": "(?\u003c=\\})",
          "patterns": [
            {
              "include": "#objectBody"
            },
            {
              "include": "#comment"
            }
          ],
          "beginCaptures": {
            "1": {
              "name": "keyword.ballerina"
            }
          }
        }
      ]
    },
    "objectInitBody": {
      "patterns": [
        {
          "begin": "\\{",
          "end": "\\}",
          "patterns": [
            {
              "include": "#comment"
            },
            {
              "include": "#code"
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.block.ballerina"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.block.ballerina"
            }
          }
        }
      ]
    },
    "objectInitDec": {
      "patterns": [
        {
          "begin": "\\b(new)\\b",
          "end": "(?\u003c=\\})",
          "patterns": [
            {
              "include": "#objectInitParameters"
            },
            {
              "include": "#objectInitBody"
            }
          ],
          "beginCaptures": {
            "1": {
              "name": "keyword.ballerina"
            }
          }
        }
      ]
    },
    "objectInitParameters": {
      "patterns": [
        {
          "begin": "\\(",
          "end": "\\)",
          "patterns": [
            {
              "include": "#types"
            },
            {
              "name": "variable.parameter.ballerina",
              "match": "\\b(([a-zA-Z_]([a-zA-Z0-9_])*)|(\\^\"([^|\"\\\\\\f\\n\\r\\t]|\\\\\\\\[btnfr]|\\\\[|\"\\\\/])+\"))\\b"
            },
            {
              "include": "#defaultValue"
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.parameters.begin.ballerina"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.parameters.end.ballerina"
            }
          }
        }
      ]
    },
    "paranthesised": {
      "patterns": [
        {
          "begin": "\\(",
          "end": "\\)",
          "patterns": [
            {
              "include": "#comment"
            },
            {
              "include": "#code"
            }
          ]
        }
      ]
    },
    "paranthesisedBracket": {
      "patterns": [
        {
          "begin": "\\[",
          "end": "\\]",
          "patterns": [
            {
              "include": "#comment"
            },
            {
              "include": "#code"
            }
          ]
        }
      ]
    },
    "publicKeyword": {
      "patterns": [
        {
          "name": "keyword.ballerina",
          "match": "\\bpublic\\b"
        }
      ]
    },
    "resourceBody": {
      "patterns": [
        {
          "begin": "\\{",
          "end": "\\}",
          "patterns": [
            {
              "include": "#comment"
            },
            {
              "include": "#code"
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.block.ballerina"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.block.ballerina"
            }
          }
        }
      ]
    },
    "resourceDef": {
      "patterns": [
        {
          "begin": "\\b(([a-zA-Z_]([a-zA-Z0-9_])*)|(\\^\"([^|\"\\\\\\f\\n\\r\\t]|\\\\\\\\[btnfr]|\\\\[|\"\\\\/])+\"))\\b",
          "end": "(?\u003c=\\})",
          "patterns": [
            {
              "include": "#comment"
            },
            {
              "include": "#functionParameters"
            },
            {
              "include": "#resourceBody"
            }
          ],
          "beginCaptures": {
            "1": {
              "name": "entity.name.function.ballerina"
            }
          }
        }
      ]
    },
    "serviceBody": {
      "patterns": [
        {
          "begin": "\\{",
          "end": "\\}",
          "patterns": [
            {
              "include": "#comment"
            },
            {
              "include": "#documentationDef"
            },
            {
              "include": "#annotationDec"
            },
            {
              "include": "#resourceDef"
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.block.ballerina"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.block.ballerina"
            }
          }
        }
      ]
    },
    "serviceDec": {
      "patterns": [
        {
          "begin": "\\b(service)\\b",
          "end": "(?\u003c=\\})",
          "patterns": [
            {
              "include": "#serviceReceiver"
            },
            {
              "include": "#serviceEndpointAttachments"
            },
            {
              "include": "#serviceName"
            },
            {
              "include": "#serviceBody"
            },
            {
              "include": "#comment"
            }
          ],
          "beginCaptures": {
            "1": {
              "name": "keyword.ballerina"
            }
          }
        }
      ]
    },
    "serviceEndpointAttachments": {
      "patterns": [
        {
          "begin": "bind",
          "end": "(?=\\{)",
          "patterns": [
            {
              "name": "variable.parameter.ballerina",
              "match": "([a-zA-Z_]([a-zA-Z0-9_])*)|(\\^\"([^|\"\\\\\\f\\n\\r\\t]|\\\\\\\\[btnfr]|\\\\[|\"\\\\/])+\")"
            },
            {
              "include": "#comment"
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "keyword.ballerina"
            }
          }
        }
      ]
    },
    "serviceName": {
      "patterns": [
        {
          "name": "entity.name.function.ballerina",
          "match": "([a-zA-Z_]([a-zA-Z0-9_])*)|(\\^\"([^|\"\\\\\\f\\n\\r\\t]|\\\\\\\\[btnfr]|\\\\[|\"\\\\/])+\")"
        }
      ]
    },
    "serviceReceiver": {
      "patterns": [
        {
          "begin": "\u003c",
          "end": "\u003e",
          "patterns": [
            {
              "name": "storage.type.ballerina",
              "match": "([a-zA-Z_]([a-zA-Z0-9_])*)|(\\^\"([^|\"\\\\\\f\\n\\r\\t]|\\\\\\\\[btnfr]|\\\\[|\"\\\\/])+\")"
            },
            {
              "include": "#comment"
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.parameters.begin.ballerina"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.parameters.end.ballerina"
            }
          }
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.double.ballerina",
          "begin": "\\\"",
          "end": "\\\"",
          "patterns": [
            {
              "name": "constant.character.escape.ballerina",
              "match": "\\\\."
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.string.begin.ballerina"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.string.end.ballerina"
            }
          }
        }
      ]
    },
    "typeDef": {
      "patterns": [
        {
          "begin": "\\b(type)\\b",
          "end": "\\b(([a-zA-Z_]([a-zA-Z0-9_])*)|(\\^\"([^|\"\\\\\\f\\n\\r\\t]|\\\\\\\\[btnfr]|\\\\[|\"\\\\/])+\"))\\b",
          "patterns": [
            {
              "include": "#objectDec"
            },
            {
              "name": "entity.name.function.ballerina",
              "match": "([a-zA-Z_]([a-zA-Z0-9_])*)|(\\^\"([^|\"\\\\\\f\\n\\r\\t]|\\\\\\\\[btnfr]|\\\\[|\"\\\\/])+\")"
            },
            {
              "include": "#comment"
            }
          ],
          "beginCaptures": {
            "1": {
              "name": "keyword.ballerina"
            }
          },
          "endCaptures": {
            "1": {
              "name": "entity.name.function.ballerina"
            }
          }
        }
      ]
    },
    "types": {
      "patterns": [
        {
          "name": "storage.type.ballerina",
          "match": "\\b(boolean|int|float|string|var|any|datatable|table|blob)\\b"
        },
        {
          "name": "storage.type.ballerina",
          "match": "\\b(map|exception|json|xml|xmlns|error)\\b"
        },
        {
          "name": "storage.type.siddhi.ballerina",
          "match": "\\b(stream|streamlet|aggregation)\\b"
        }
      ]
    },
    "varDefBlock": {
      "patterns": [
        {
          "begin": "\\b(private|public)\\b",
          "end": "(?\u003c=\\})",
          "patterns": [
            {
              "include": "#varDefBlockBody"
            },
            {
              "include": "#functionDec"
            }
          ],
          "beginCaptures": {
            "1": {
              "name": "keyword.ballerina"
            }
          }
        }
      ]
    },
    "varDefBlockBody": {
      "patterns": [
        {
          "begin": "\\{",
          "end": "\\}",
          "patterns": [
            {
              "include": "#comment"
            },
            {
              "include": "#varDefStatement"
            }
          ],
          "beginCaptures": {
            "0": {
              "name": "punctuation.definition.block.ballerina.documentation"
            }
          },
          "endCaptures": {
            "0": {
              "name": "punctuation.definition.block.ballerina.documentation"
            }
          }
        }
      ]
    },
    "varDefStatement": {
      "patterns": [
        {
          "begin": "\\b(([a-zA-Z_]([a-zA-Z0-9_])*)|(\\^\"([^|\"\\\\\\f\\n\\r\\t]|\\\\\\\\[btnfr]|\\\\[|\"\\\\/])+\"))\\b",
          "end": "\\b(([a-zA-Z_]([a-zA-Z0-9_])*)|(\\^\"([^|\"\\\\\\f\\n\\r\\t]|\\\\\\\\[btnfr]|\\\\[|\"\\\\/])+\"))\\b|(?==\u003e)",
          "patterns": [
            {
              "include": "#continuedType"
            },
            {
              "include": "#constrainType"
            },
            {
              "include": "#comment"
            }
          ],
          "beginCaptures": {
            "1": {
              "name": "storage.type.ballerina"
            }
          },
          "endCaptures": {
            "1": {
              "name": "variable.parameter.ballerina"
            }
          }
        }
      ]
    }
  }
}
